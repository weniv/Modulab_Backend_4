# ìœ ìˆ˜ì§„ í”„ë¡œì íŠ¸ ì½”ë“œ ë¦¬ë·°

## í”„ë¡œì íŠ¸ ì†Œê°œ
ë¯¸ë˜ ì‹œë‚˜ë¦¬ì˜¤ë¥¼ í•¨ê»˜ ê·¸ë ¤ì£¼ëŠ” íë§ ì±—ë´‡ì€ í˜„ì¬ì˜ ì–´ë ¤ì›€ì„ ê²ªê³  ìˆëŠ” ì‚¬ëŒë“¤ì—ê²Œ í¬ë§ê³¼ ìœ„ë¡œë¥¼ ì „í•˜ëŠ” AI ìƒë‹´ ì„œë¹„ìŠ¤ì…ë‹ˆë‹¤. ì‚¬ìš©ìê°€ ìì‹ ì˜ ê¿ˆì´ë‚˜ ëª©í‘œ, í˜„ì¬ì˜ ê³ ë¯¼ì„ ê³µìœ í•˜ë©´, AIê°€ ê¸ì •ì ì´ê³  ì‹¤í˜„ ê°€ëŠ¥í•œ ë¯¸ë˜ ì‹œë‚˜ë¦¬ì˜¤ë¥¼ ê·¸ë ¤ì£¼ë©° ì •ì„œì  ì§€ì›ì„ ì œê³µí•©ë‹ˆë‹¤. ë”°ëœ»í•œ ëŒ€í™”ë¥¼ í†µí•´ ìê¸° ê¸ì •ê°ì„ ë†’ì´ê³ , ë¯¸ë˜ì— ëŒ€í•œ í¬ë§ì„ ê°–ë„ë¡ ë•ìŠµë‹ˆë‹¤.

## í”„ë¡œì íŠ¸ ì •ë³´
- **í”„ë¡œì íŠ¸ëª…**: ë¯¸ë˜ ì‹œë‚˜ë¦¬ì˜¤ë¥¼ í•¨ê»˜ ê·¸ë ¤ì£¼ëŠ” íë§ ì±—ë´‡
- **ì €ì¥ì†Œ**: https://github.com/ìœ ìˆ˜ì§„/healing-future-chatbot
- **ê¸°ìˆ  ìŠ¤íƒ**: FastAPI, HTML/CSS/JavaScript, ChatGPT API, SHA256 ë¹„ë°€ë²ˆí˜¸ í•´ì‹±
- **ëª©í‘œ**: ì •ì„œì  ìœ„ì•ˆ, ìƒìƒë ¥ ìê·¹, ê¸ì •ì  ìê¸° ì´ë¯¸ì§€ ì œê³µí•˜ëŠ” AI ì±—ë´‡

## í˜„ì¬ ìƒíƒœ ë¶„ì„ (ì—…ë°ì´íŠ¸)
í”„ë¡œì íŠ¸ê°€ **ì™„ì „íˆ êµ¬í˜„ëœ ìƒíƒœ**ì…ë‹ˆë‹¤. ìµœê·¼ì—ëŠ” ë¬¸ì„œí™” ì‘ì—…ì´ ì§„í–‰ë˜ì—ˆìœ¼ë©°(README.md êµ¬ì¡°í™”, ì™€ì´ì–´í”„ë ˆì„ ì¶”ê°€), ë°±ì—”ë“œì™€ í”„ë¡ íŠ¸ì—”ë“œê°€ ì˜ í†µí•©ë˜ì–´ ì‘ë™í•©ë‹ˆë‹¤. í”„ë¡œì íŠ¸ëª…ì´ "ë°©êµ¬ì„ íë§ ì±—ë´‡"ìœ¼ë¡œ ë¸Œëœë”©ë˜ì—ˆìŠµë‹ˆë‹¤.

### êµ¬í˜„ëœ ì£¼ìš” ê¸°ëŠ¥
1. **ì‚¬ìš©ì ì¸ì¦ ì‹œìŠ¤í…œ**: íšŒì›ê°€ì…, ë¡œê·¸ì¸, ë¡œê·¸ì•„ì›ƒ, ì„¸ì…˜ ê´€ë¦¬
2. **ChatGPT í†µí•©**: ë¹„ë™ê¸° API í˜¸ì¶œë¡œ AI ì‘ë‹µ ìƒì„±
3. **ì±„íŒ… ì¸í„°í˜ì´ìŠ¤**: ì‹¤ì‹œê°„ ë©”ì‹œì§€ ì „ì†¡ ë° í‘œì‹œ
4. **ì—ëŸ¬ ì²˜ë¦¬**: ì¬ì‹œë„ ë¡œì§ ë° ì‚¬ìš©ì ì¹œí™”ì  ì—ëŸ¬ ë©”ì‹œì§€

## ì˜ëœ ì  ğŸ‘

### 1. ì™„ì„±ë„ ë†’ì€ êµ¬í˜„
- ë°±ì—”ë“œì™€ í”„ë¡ íŠ¸ì—”ë“œê°€ ëª¨ë‘ êµ¬í˜„ë˜ì–´ ìˆìŒ
- íšŒì›ê°€ì…, ë¡œê·¸ì¸, ì±„íŒ… ê¸°ëŠ¥ì´ ì‹¤ì œë¡œ ì‘ë™
- ì—ëŸ¬ ì²˜ë¦¬ì™€ ì¬ì‹œë„ ë¡œì§ì´ ì˜ êµ¬í˜„ë¨

### 2. ì½”ë“œ í’ˆì§ˆ
- **í•œê¸€ ì£¼ì„ê³¼ í•¨ìˆ˜ëª…**: `ë‚´ì •ë³´ë³´ê¸°`, `ë¡œê·¸ì•„ì›ƒ` ë“± ì§ê´€ì ì¸ ë„¤ì´ë°
- **ìƒì„¸í•œ docstring**: ê° í•¨ìˆ˜ì˜ ë™ì‘ ê³¼ì •ì„ ë‹¨ê³„ë³„ë¡œ ì„¤ëª…
- **Pydantic ëª¨ë¸**: íƒ€ì… ì•ˆì „ì„± í™•ë³´
- **ì½”ë“œ ë¦¬ë·° ì£¼ì„**: ê°œì„ ì ì„ ë¯¸ë¦¬ í‘œì‹œ

### 3. ì‚¬ìš©ì ê²½í—˜
- ë¡œë”© ì¸ë””ì¼€ì´í„°ë¡œ ì‚¬ìš©ì í”¼ë“œë°± ì œê³µ
- Enter í‚¤ì™€ ë²„íŠ¼ í´ë¦­ ëª¨ë‘ ì§€ì›
- ê¹”ë”í•˜ê³  ëª¨ë˜í•œ UI ë””ìì¸
- ì‘ë‹µí˜• ë””ìì¸ìœ¼ë¡œ ëª¨ë°”ì¼ ì§€ì›

### 4. ë¹„ë™ê¸° ì²˜ë¦¬
- httpxë¥¼ ì‚¬ìš©í•œ ë¹„ë™ê¸° API í˜¸ì¶œ
- async/await íŒ¨í„´ ì˜¬ë°”ë¥´ê²Œ ì‚¬ìš©
- íƒ€ì„ì•„ì›ƒ ì„¤ì •ìœ¼ë¡œ ë¬´í•œ ëŒ€ê¸° ë°©ì§€

### 5. ë³´ì•ˆ ê³ ë ¤ì‚¬í•­
- HttpOnly ì¿ í‚¤ ì‚¬ìš©
- ì„¸ì…˜ ê¸°ë°˜ ì¸ì¦
- ë¹„ë°€ë²ˆí˜¸ í•´ì‹± (SHA256)
- CORS ì„¤ì •

## ê°œì„ ì´ í•„ìš”í•œ ì  ë° ë³´ì™„ ë°©ë²• âš ï¸

### 1. ë³´ì•ˆ ê°•í™”
**ë¬¸ì œì **: 
- SHA256ì€ ë¹„ë°€ë²ˆí˜¸ í•´ì‹±ì— ì í•©í•˜ì§€ ì•ŠìŒ
- ì„¸ì…˜ ë§Œë£Œ ì‹œê°„ ê´€ë¦¬ ë¯¸í¡
- CORS ì„¤ì •ì´ ë„ˆë¬´ ê°œë°©ì 

**ë³´ì™„ ë°©ë²•**:
```python
# bcrypt ì‚¬ìš©
from passlib.context import CryptContext

pwd_context = CryptContext(schemes=["bcrypt"], deprecated="auto")

def hash_password(password: str) -> str:
    return pwd_context.hash(password)

def verify_password(plain_password: str, hashed_password: str) -> bool:
    return pwd_context.verify(plain_password, hashed_password)

# ì„¸ì…˜ ë§Œë£Œ ì‹œê°„ ì¶”ê°€
from datetime import datetime, timedelta

def create_session(username: str) -> str:
    session_id = str(uuid.uuid4())
    user_sessions[session_id] = {
        "username": username,
        "expires_at": datetime.now() + timedelta(hours=24)
    }
    return session_id

def get_current_user(session_id: str) -> Optional[dict]:
    session_data = user_sessions.get(session_id)
    if not session_data:
        return None
    
    # ë§Œë£Œ ì‹œê°„ í™•ì¸
    if datetime.now() > session_data["expires_at"]:
        del user_sessions[session_id]
        return None
    
    username = session_data["username"]
    return users_db.get(username)

# CORS ì„¤ì • ê°œì„ 
app.add_middleware(
    CORSMiddleware,
    allow_origins=["http://localhost:3000", "https://your-domain.com"],
    allow_credentials=True,
    allow_methods=["GET", "POST"],
    allow_headers=["Content-Type", "Authorization"],
)
```

### 2. íë§ ì±—ë´‡ íŠ¹í™” ê¸°ëŠ¥
**ë¬¸ì œì **: ì¼ë°˜ì ì¸ ì±—ë´‡ìœ¼ë¡œ êµ¬í˜„ë˜ì–´ ìˆì–´ íë§ ì±—ë´‡ì˜ íŠ¹ì„±ì´ ë¶€ì¡±

**ë³´ì™„ ë°©ë²•**:
```python
# chatgpt_api.py ìˆ˜ì •
def get_healing_prompt(user_emotion: str = None) -> str:
    """ì‚¬ìš©ì ê°ì •ì— ë”°ë¥¸ ë§ì¶¤í˜• í”„ë¡¬í”„íŠ¸ ìƒì„±"""
    base_prompt = """ë‹¹ì‹ ì€ ë”°ëœ»í•˜ê³  ê³µê°ì ì¸ íë§ ìƒë‹´ì‚¬ì…ë‹ˆë‹¤.
    ì‚¬ìš©ìì˜ í˜„ì¬ ìƒí™©ì„ ë“£ê³ , ê¸ì •ì ì¸ ë¯¸ë˜ ì‹œë‚˜ë¦¬ì˜¤ë¥¼ í•¨ê»˜ ê·¸ë ¤ì£¼ì„¸ìš”.
    
    ëŒ€í™” ê°€ì´ë“œë¼ì¸:
    1. ë¨¼ì € ì‚¬ìš©ìì˜ ê°ì •ì„ ì¸ì •í•˜ê³  ê³µê°í•´ì£¼ì„¸ìš”
    2. í˜„ì¬ ìƒí™©ì—ì„œ ì°¾ì„ ìˆ˜ ìˆëŠ” ì‘ì€ ê¸ì •ì  ìš”ì†Œë¥¼ ë°œê²¬í•´ì£¼ì„¸ìš”
    3. 1ë…„ í›„, 5ë…„ í›„ì˜ í¬ë§ì ì¸ ë¯¸ë˜ë¥¼ êµ¬ì²´ì ìœ¼ë¡œ ê·¸ë ¤ì£¼ì„¸ìš”
    4. ê·¸ ë¯¸ë˜ë¥¼ ìœ„í•œ ì‘ì€ ì²«ê±¸ìŒì„ ì œì•ˆí•´ì£¼ì„¸ìš”
    5. í•­ìƒ ë”°ëœ»í•˜ê³  ê²©ë ¤í•˜ëŠ” í†¤ì„ ìœ ì§€í•´ì£¼ì„¸ìš”
    """
    
    emotion_prompts = {
        "sad": "\níŠ¹íˆ ìŠ¬í”” ì†ì—ì„œë„ ì„±ì¥ì˜ ê¸°íšŒë¥¼ ì°¾ì„ ìˆ˜ ìˆë„ë¡ ë„ì™€ì£¼ì„¸ìš”.",
        "anxious": "\në¶ˆì•ˆì„ ì¤„ì´ê³  ì•ˆì •ê°ì„ ì°¾ì„ ìˆ˜ ìˆëŠ” êµ¬ì²´ì ì¸ ë°©ë²•ì„ ì œì‹œí•´ì£¼ì„¸ìš”.",
        "angry": "\në¶„ë…¸ì˜ ì—ë„ˆì§€ë¥¼ ê¸ì •ì ì¸ ë³€í™”ì˜ ë™ë ¥ìœ¼ë¡œ ì „í™˜í•  ìˆ˜ ìˆë„ë¡ ì•ˆë‚´í•´ì£¼ì„¸ìš”.",
        "lonely": "\ní˜¼ìê°€ ì•„ë‹ˆë©°, ì—°ê²°ë  ìˆ˜ ìˆëŠ” ë°©ë²•ë“¤ì„ ì œì‹œí•´ì£¼ì„¸ìš”."
    }
    
    return base_prompt + emotion_prompts.get(user_emotion, "")

# ê°ì • ë¶„ì„ ê¸°ëŠ¥ ì¶”ê°€
async def analyze_emotion(text: str) -> str:
    """í…ìŠ¤íŠ¸ì—ì„œ ê°ì •ì„ ë¶„ì„"""
    emotion_keywords = {
        "sad": ["ìŠ¬í”„", "ìš°ìš¸", "í˜ë“¤", "ì™¸ë¡œ", "ëˆˆë¬¼", "ì•„í”„"],
        "anxious": ["ë¶ˆì•ˆ", "ê±±ì •", "ë‘ë µ", "ë¬´ì„œ", "ê¸´ì¥", "ì´ˆì¡°"],
        "angry": ["í™”ë‚˜", "ì§œì¦", "ë¶„ë…¸", "ì—´ë°›", "ì–µìš¸", "ë‹µë‹µ"],
        "lonely": ["ì™¸ë¡œ", "í˜¼ì", "ì“¸ì“¸", "ê³ ë…", "ê·¸ë¦¬ì›Œ"],
        "happy": ["ê¸°ì˜", "í–‰ë³µ", "ì¦ê±°", "ì‹ ë‚˜", "ì¢‹ì•„", "ì›ƒ"]
    }
    
    text_lower = text.lower()
    for emotion, keywords in emotion_keywords.items():
        if any(keyword in text_lower for keyword in keywords):
            return emotion
    return "neutral"

# ask_chatgpt_async í•¨ìˆ˜ ìˆ˜ì •
async def ask_chatgpt_async(user_id: str, prompt_content: str) -> str:
    # ê°ì • ë¶„ì„
    emotion = await analyze_emotion(prompt_content)
    
    # ê°ì •ë³„ ë§ì¶¤ í”„ë¡¬í”„íŠ¸
    system_prompt = get_healing_prompt(emotion)
    
    messages = [
        {"role": "system", "content": system_prompt},
        {"role": "user", "content": prompt_content}
    ]
    
    # ë‚˜ë¨¸ì§€ ì½”ë“œëŠ” ë™ì¼...
```

### 3. ë°ì´í„° ì˜ì†ì„±
**ë¬¸ì œì **: ë©”ëª¨ë¦¬ ê¸°ë°˜ ì €ì¥ìœ¼ë¡œ ì„œë²„ ì¬ì‹œì‘ ì‹œ ë°ì´í„° ì†ì‹¤

**ë³´ì™„ ë°©ë²•**:
```python
# SQLite ë°ì´í„°ë² ì´ìŠ¤ ì‚¬ìš©
import sqlite3
from contextlib import contextmanager

def init_db():
    conn = sqlite3.connect('healing_chatbot.db')
    cursor = conn.cursor()
    
    # ì‚¬ìš©ì í…Œì´ë¸”
    cursor.execute('''
        CREATE TABLE IF NOT EXISTS users (
            id TEXT PRIMARY KEY,
            username TEXT UNIQUE NOT NULL,
            email TEXT UNIQUE NOT NULL,
            hashed_password TEXT NOT NULL,
            created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
        )
    ''')
    
    # ì±„íŒ… ê¸°ë¡ í…Œì´ë¸”
    cursor.execute('''
        CREATE TABLE IF NOT EXISTS chat_history (
            id TEXT PRIMARY KEY,
            user_id TEXT NOT NULL,
            sender_type TEXT NOT NULL,
            content TEXT NOT NULL,
            emotion TEXT,
            created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
            FOREIGN KEY (user_id) REFERENCES users (id)
        )
    ''')
    
    # ì„¸ì…˜ í…Œì´ë¸”
    cursor.execute('''
        CREATE TABLE IF NOT EXISTS sessions (
            session_id TEXT PRIMARY KEY,
            username TEXT NOT NULL,
            expires_at TIMESTAMP NOT NULL,
            created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
            FOREIGN KEY (username) REFERENCES users (username)
        )
    ''')
    
    conn.commit()
    conn.close()

@contextmanager
def get_db():
    conn = sqlite3.connect('healing_chatbot.db')
    conn.row_factory = sqlite3.Row
    try:
        yield conn
    finally:
        conn.close()
```

### 4. ì‚¬ìš©ìë³„ ëŒ€í™” ê´€ë¦¬
**ë¬¸ì œì **: ëª¨ë“  ë©”ì‹œì§€ê°€ í•˜ë‚˜ì˜ ë”•ì…”ë„ˆë¦¬ì— ì €ì¥ë˜ì–´ ê´€ë¦¬ê°€ ì–´ë ¤ì›€

**ë³´ì™„ ë°©ë²•**:
```python
# ì‚¬ìš©ìë³„ ëŒ€í™” ê´€ë¦¬
from collections import defaultdict
from typing import List

# ì‚¬ìš©ìë³„ ë©”ì‹œì§€ ì €ì¥ì†Œ
user_messages_db: Dict[str, List[ChatMessage]] = defaultdict(list)

# main.py ìˆ˜ì •
@app.post("/chat", response_model=ChatMessage)
async def send_message(request: ChatRequest, session_id: Optional[str] = Cookie(None)):
    # ë¡œê·¸ì¸ í™•ì¸
    if not session_id:
        raise HTTPException(status_code=401, detail="ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤")
    
    user = get_current_user(session_id)
    if not user:
        raise HTTPException(status_code=401, detail="ìœ íš¨í•˜ì§€ ì•Šì€ ì„¸ì…˜ì…ë‹ˆë‹¤")
    
    user_id = user.username
    user_message_content = request.content
    
    # ì‚¬ìš©ì ë©”ì‹œì§€ ì €ì¥
    user_message = ChatMessage(
        userId=user_id,
        senderType="user",
        content=user_message_content
    )
    user_messages_db[user_id].append(user_message)
    
    try:
        # ëŒ€í™” ì»¨í…ìŠ¤íŠ¸ í¬í•¨
        context = user_messages_db[user_id][-10:]  # ìµœê·¼ 10ê°œ ë©”ì‹œì§€
        bot_response_content = await ask_chatgpt_async(
            user_id=user_id, 
            prompt_content=user_message_content,
            context=context
        )
    except Exception as e:
        raise HTTPException(status_code=500, detail=f"ì±—ë´‡ ì„œë²„ì—ì„œ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: {str(e)}")
    
    # ë´‡ ì‘ë‹µ ì €ì¥
    bot_message = ChatMessage(
        userId=user_id,
        senderType="ai",
        content=bot_response_content
    )
    user_messages_db[user_id].append(bot_message)
    
    return bot_message

@app.get("/chat/history")
async def get_chat_history(
    session_id: Optional[str] = Cookie(None),
    limit: int = 50
):
    """ì‚¬ìš©ìì˜ ì±„íŒ… ê¸°ë¡ ì¡°íšŒ"""
    if not session_id:
        raise HTTPException(status_code=401, detail="ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤")
    
    user = get_current_user(session_id)
    if not user:
        raise HTTPException(status_code=401, detail="ìœ íš¨í•˜ì§€ ì•Šì€ ì„¸ì…˜ì…ë‹ˆë‹¤")
    
    user_messages = user_messages_db.get(user.username, [])
    
    return {
        "messages": user_messages[-limit:],
        "total": len(user_messages)
    }
```

### 5. í™˜ê²½ ë³€ìˆ˜ ê´€ë¦¬
**ë¬¸ì œì **: API URLê³¼ ì„¤ì •ê°’ì´ í•˜ë“œì½”ë”©ë˜ì–´ ìˆìŒ

**ë³´ì™„ ë°©ë²•**:
```python
# config.py
from pydantic_settings import BaseSettings

class Settings(BaseSettings):
    api_url: str = "https://dev.wenivops.co.kr/services/openai-api"
    api_key: str = ""
    session_secret: str = "your-secret-key-here"
    database_url: str = "sqlite:///./healing_chatbot.db"
    session_timeout: int = 3600  # 1ì‹œê°„
    
    class Config:
        env_file = ".env"

settings = Settings()

# .env íŒŒì¼ ìƒì„±
API_URL=https://dev.wenivops.co.kr/services/openai-api
SESSION_SECRET=your-secret-key-here
DATABASE_URL=sqlite:///./healing_chatbot.db
SESSION_TIMEOUT=3600
```

### 6. ë¡œê¹… ì‹œìŠ¤í…œ
**ë¬¸ì œì **: printë¬¸ìœ¼ë¡œë§Œ ë””ë²„ê¹…

**ë³´ì™„ ë°©ë²•**:
```python
import logging
from logging.handlers import RotatingFileHandler

# ë¡œê¹… ì„¤ì •
def setup_logging():
    logger = logging.getLogger("healing_chatbot")
    logger.setLevel(logging.INFO)
    
    # íŒŒì¼ í•¸ë“¤ëŸ¬ (ë¡œê·¸ íŒŒì¼ ìë™ íšŒì „)
    file_handler = RotatingFileHandler(
        "app.log",
        maxBytes=10485760,  # 10MB
        backupCount=5
    )
    
    # ì½˜ì†” í•¸ë“¤ëŸ¬
    console_handler = logging.StreamHandler()
    
    # í¬ë§·í„°
    formatter = logging.Formatter(
        '%(asctime)s - %(name)s - %(levelname)s - %(message)s'
    )
    file_handler.setFormatter(formatter)
    console_handler.setFormatter(formatter)
    
    logger.addHandler(file_handler)
    logger.addHandler(console_handler)
    
    return logger

logger = setup_logging()

# print ëŒ€ì‹  logger ì‚¬ìš©
logger.info(f"ì‘ë‹µ ìƒíƒœ ì½”ë“œ: {response.status_code}")
logger.error(f"API ì˜¤ë¥˜: {e}")
```

## ìƒˆë¡œìš´ ê¸°ëŠ¥ ì œì•ˆ ğŸ’¡

### 1. ê°ì • í†µê³„ ëŒ€ì‹œë³´ë“œ
```python
@app.get("/stats/emotions")
async def get_emotion_stats(session_id: Optional[str] = Cookie(None)):
    """ì‚¬ìš©ìì˜ ê°ì • ë³€í™” í†µê³„"""
    # êµ¬í˜„: ì‹œê°„ëŒ€ë³„ ê°ì • ë¶„ì„, ì£¼ìš” ê°ì • íŒ¨í„´ ë“±
    pass
```

### 2. ë¯¸ë˜ ì¼ê¸° ê¸°ëŠ¥
```python
class FutureDiary(BaseModel):
    title: str
    content: str
    target_date: datetime
    emotions: List[str]
    
@app.post("/diary/future")
async def create_future_diary(diary: FutureDiary, session_id: Optional[str] = Cookie(None)):
    """ë¯¸ë˜ ì‹œë‚˜ë¦¬ì˜¤ë¥¼ ì¼ê¸° í˜•íƒœë¡œ ì €ì¥"""
    pass
```

### 3. ê¸ì • ì•Œë¦¼ ê¸°ëŠ¥
```python
@app.post("/reminders/positive")
async def set_positive_reminder(
    time: str,
    message: str,
    session_id: Optional[str] = Cookie(None)
):
    """ì •ê¸°ì ì¸ ê¸ì • ë©”ì‹œì§€ ì•Œë¦¼ ì„¤ì •"""
    pass
```

### 4. ìŒì„± ëŒ€í™” ê¸°ëŠ¥
```python
@app.post("/chat/voice")
async def voice_chat(audio_file: UploadFile, session_id: Optional[str] = Cookie(None)):
    """ìŒì„±ì„ í…ìŠ¤íŠ¸ë¡œ ë³€í™˜ í›„ ì±„íŒ…"""
    # STT API ì—°ë™
    pass
```

### 5. ê°ì • ì‹œê°í™”
```python
@app.get("/visualization/emotions")
async def get_emotion_visualization(session_id: Optional[str] = Cookie(None)):
    """ê°ì • ë³€í™”ë¥¼ ì°¨íŠ¸ë¡œ ì‹œê°í™”"""
    # Chart.js ë°ì´í„° ë°˜í™˜
    pass
```

## ì„±ëŠ¥ ìµœì í™” ì œì•ˆ ğŸš€

### 1. ì‘ë‹µ ìºì‹±
```python
from functools import lru_cache
import hashlib

@lru_cache(maxsize=100)
def get_cached_response(prompt_hash: str):
    """ìì£¼ ë¬»ëŠ” ì§ˆë¬¸ì— ëŒ€í•œ ì‘ë‹µ ìºì‹±"""
    pass

def get_prompt_hash(prompt: str) -> str:
    """í”„ë¡¬í”„íŠ¸ì˜ í•´ì‹œê°’ ìƒì„±"""
    return hashlib.md5(prompt.encode()).hexdigest()
```

### 2. ë¹„ë™ê¸° ì‘ì—… í
```python
from asyncio import Queue

# ë©”ì‹œì§€ ì²˜ë¦¬ í
message_queue = Queue(maxsize=100)

async def process_message_queue():
    """ë°±ê·¸ë¼ìš´ë“œì—ì„œ ë©”ì‹œì§€ ì²˜ë¦¬"""
    while True:
        message = await message_queue.get()
        # ì²˜ë¦¬ ë¡œì§
```

## í…ŒìŠ¤íŠ¸ ì½”ë“œ ì¶”ê°€ ê¶Œì¥ ğŸ§ª
```python
# test_main.py
import pytest
from fastapi.testclient import TestClient
from main import app

client = TestClient(app)

def test_register():
    response = client.post("/register", json={
        "username": "testuser",
        "email": "test@example.com",
        "password": "testpass123"
    })
    assert response.status_code == 200
    assert "íšŒì›ê°€ì…ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤" in response.json()["message"]

def test_login():
    response = client.post("/login", json={
        "username": "testuser",
        "password": "testpass123"
    })
    assert response.status_code == 200
    assert "session_id" in response.cookies

@pytest.mark.asyncio
async def test_chat():
    # ë¡œê·¸ì¸ í›„ ì±„íŒ… í…ŒìŠ¤íŠ¸
    pass
```

## ë°°í¬ ì¤€ë¹„ì‚¬í•­ ğŸ“¦

### 1. requirements.txt ì—…ë°ì´íŠ¸
```txt
fastapi==0.104.1
uvicorn[standard]==0.24.0
python-multipart==0.0.6
httpx==0.25.1
pydantic==2.5.0
pydantic-settings==2.1.0
passlib[bcrypt]==1.7.4
aiosqlite==0.19.0
pytest==7.4.3
pytest-asyncio==0.21.1
```
**ì°¸ê³ **: ê¸°ë³¸ì ì¸ `requirements.txt` íŒŒì¼ì´ ì´ë¯¸ ì¶”ê°€ë˜ì—ˆìœ¼ë‚˜, ìœ„ì˜ ê¶Œì¥ íŒ¨í‚¤ì§€ë“¤ë¡œ ì—…ë°ì´íŠ¸í•˜ë©´ ë”ìš± ì•ˆì •ì ì¸ ìš´ì˜ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤.

### 2. Docker ì»¨í…Œì´ë„ˆí™”
```dockerfile
FROM python:3.11-slim

WORKDIR /app

# ì˜ì¡´ì„± ì„¤ì¹˜
COPY requirements.txt .
RUN pip install --no-cache-dir -r requirements.txt

# ì• í”Œë¦¬ì¼€ì´ì…˜ ë³µì‚¬
COPY . .

# í¬íŠ¸ ë…¸ì¶œ
EXPOSE 8000

# ì‹¤í–‰
CMD ["uvicorn", "back.main:app", "--host", "0.0.0.0", "--port", "8000"]
```

### 3. docker-compose.yml
```yaml
version: '3.8'

services:
  web:
    build: .
    ports:
      - "8000:8000"
    environment:
      - API_URL=${API_URL}
      - SESSION_SECRET=${SESSION_SECRET}
    volumes:
      - ./data:/app/data
    restart: unless-stopped
```

## ì¢…í•© í‰ê°€
ìœ ìˆ˜ì§„ ë‹˜ì˜ í”„ë¡œì íŠ¸ëŠ” **ë§¤ìš° ì™„ì„±ë„ ë†’ê²Œ êµ¬í˜„**ë˜ì—ˆìŠµë‹ˆë‹¤. íŠ¹íˆ ë‹¤ìŒ ì ë“¤ì´ ì¸ìƒì ì…ë‹ˆë‹¤:

1. **ì™„ì „í•œ ê¸°ëŠ¥ êµ¬í˜„**: ì¸ì¦, ì±„íŒ…, UI ëª¨ë‘ ì‘ë™
2. **ì¹œì ˆí•œ ì½”ë“œ**: í•œê¸€ ì£¼ì„ê³¼ ì§ê´€ì ì¸ ë„¤ì´ë°
3. **ì‚¬ìš©ì ê²½í—˜ ê³ ë ¤**: ë¡œë”© í‘œì‹œ, ì—ëŸ¬ ì²˜ë¦¬, ë°˜ì‘í˜• ë””ìì¸
4. **ê°œì„ ì  ì¸ì§€**: ì½”ë“œ ë‚´ ë¦¬ë·° ì£¼ì„ìœ¼ë¡œ ê°œì„ ì  í‘œì‹œ

ì£¼ìš” ê°œì„  ì‚¬í•­ìœ¼ë¡œëŠ”:
- **ë³´ì•ˆ ê°•í™”**: bcrypt ì‚¬ìš©, ì„¸ì…˜ ë§Œë£Œ ê´€ë¦¬
- **íë§ ì±—ë´‡ íŠ¹í™”**: ê°ì • ë¶„ì„, ë§ì¶¤í˜• ì‘ë‹µ
- **ë°ì´í„° ì˜ì†ì„±**: ë°ì´í„°ë² ì´ìŠ¤ ì—°ë™
- **ìš´ì˜ ì¤€ë¹„**: ë¡œê¹…, í™˜ê²½ ë³€ìˆ˜, í…ŒìŠ¤íŠ¸

ì „ì²´ì ìœ¼ë¡œ í”„ë¡œí† íƒ€ì…ì„ ë„˜ì–´ ì‹¤ì œ ì„œë¹„ìŠ¤ë¡œ ë°œì „ì‹œí‚¬ ìˆ˜ ìˆëŠ” í›Œë¥­í•œ í”„ë¡œì íŠ¸ì…ë‹ˆë‹¤! ğŸ‘